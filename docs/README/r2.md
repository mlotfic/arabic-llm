# ð”Šï¸ Hadith NLP Config Project Boilerplate

This is a practical, production-ready starter template for managing configuration-driven Hadith NLP or classical Arabic data annotation pipelines. It uses Pydantic models, YAML config files, and supports modular design for multi-agent NLP workflows.

---

## ðŸ“ Project Structure

```
.
â”œâ”€â”€ config/
â”‚   â”œâ”€â”€ hadith/
â”‚   â”‚   â”œâ”€â”€ grading_keywords.yaml
â”‚   â”‚   â”œâ”€â”€ matn_defects.yaml
â”‚   â”‚   â””â”€â”€ entity_roles.yaml
â”‚   â”œâ”€â”€ model/
â”‚   â”‚   â”œâ”€â”€ bert.yaml
â”‚   â”‚   â””â”€â”€ random_forest.yaml
â”‚   â”œâ”€â”€ paths/
â”‚   â”‚   â””â”€â”€ data.yaml
â”‚   â”œâ”€â”€ pipeline/
â”‚   â”‚   â””â”€â”€ steps.yaml
â”‚
â”œâ”€â”€ generate_yaml_skeletons.py    # ðŸ”§ YAML config bootstrapper
â”œâ”€â”€ config_loader.py              # âœ… Pydantic-based loader
â”œâ”€â”€ models.py                     # ðŸ” Validation schema
â”œâ”€â”€ api.py                        # ðŸš€ FastAPI app exposing configs
â”œâ”€â”€ main.py                       # ðŸ§ª Sample usage
â”œâ”€â”€ TurathAnnotator/              # ðŸ§  Annotation service
â”‚   â”œâ”€â”€ annotator.py
â”‚   â”œâ”€â”€ main.py
â”‚   â”œâ”€â”€ data/
â”‚   â”‚   â”œâ”€â”€ external/
â”‚   â”‚   â”œâ”€â”€ interim/
â”‚   â”‚   â”œâ”€â”€ processed/
â”‚   â”‚   â””â”€â”€ raw/
â”‚   â”œâ”€â”€ ETL/
â”‚   â”œâ”€â”€ models/
â”‚   â”‚   â””â”€â”€ ollama/
â”‚   â”œâ”€â”€ schemas/
â”‚   â””â”€â”€ src/
â”‚       â”œâ”€â”€ annotators/
â”‚       â””â”€â”€ scorers/
â”œâ”€â”€ TurathIngestor/               # ðŸ“… Data ingestion service
â”‚   â”œâ”€â”€ db_loader.py
â”‚   â”œâ”€â”€ main.py
â”‚   â”œâ”€â”€ data/
â”‚   â”œâ”€â”€ ETL/
â”‚   â”œâ”€â”€ schemas/
â”‚   â””â”€â”€ src/
â”‚
â”œâ”€â”€ modules/                      # âš™ï¸ Core shared modules
â”‚   â”œâ”€â”€ annotators/
â”‚   â”œâ”€â”€ db/
â”‚   â”œâ”€â”€ parsing/
â”‚   â”œâ”€â”€ regex/
â”‚   â”‚   â””â”€â”€ patterns.py
â”‚   â”œâ”€â”€ scorers/
â”‚   â””â”€â”€ utils/
â”‚
â”œâ”€â”€ data/                         # ðŸ“Š Central data folder
â”‚   â”œâ”€â”€ db/
â”‚   â”‚   â”œâ”€â”€ external/
â”‚   â”‚   â”œâ”€â”€ interim/
â”‚   â”‚   â””â”€â”€ processed/
â”‚
â”œâ”€â”€ configs/                      # âš™ï¸ Project configs
â”‚   â”œâ”€â”€ grading_schema.yml
â”‚   â””â”€â”€ sources.yml
â”‚
â”œâ”€â”€ docs/                         # ðŸ“š Documentation
â”œâ”€â”€ external_modules/             # ðŸ§© Third-party code
â”œâ”€â”€ notebooks/                    # ðŸ““ Jupyter notebooks
â”œâ”€â”€ reports/                      # ðŸ“ Reports and generated output
â””â”€â”€ README.md
```

---

## âš™ï¸ Setup

```bash
pip install pydantic pyyaml fastapi uvicorn
python generate_yaml_skeletons.py
```

---

## âœ… Usage Example

```python
from config_loader import load_grading_config
cfg = load_grading_config("config/hadith/grading_keywords.yaml")
print(cfg.authenticity.__root__["sahih"].keywords)
```

---

## ðŸ”¥ FastAPI Example (`api.py`)

```python
from fastapi import FastAPI
from config_loader import load_grading_config

app = FastAPI()

@app.get("/grading")
def get_grading():
    config = load_grading_config("config/hadith/grading_keywords.yaml")
    return config.dict()
```

Run it with:

```bash
uvicorn api:app --reload
```

Then visit: [http://localhost:8000/grading](http://localhost:8000/grading)

---

## ðŸ§  Design Best Practices

### âœ… Domain-Specific YAMLs

* `grading_keywords.yaml`: Tagging authenticity, isnaad status
* `matn_defects.yaml`: Detect and score matn-related issues
* `entity_roles.yaml`: Role tagging for narrator/critic/compiler

### ðŸ’¼ Naming Conventions

Use `domain_purpose.yaml` (e.g. `hadith_grading.yaml`) to avoid collisions and clarify intent.

### ðŸ“ Validation with Pydantic

Schema-based models ensure correctness and IDE autocompletion:

```python
class GradingItem(BaseModel):
    score: int
    keywords: List[str]
```

### âš ï¸ Generate Config Skeletons

```bash
python generate_yaml_skeletons.py
```

This auto-creates your config scaffolding with common defaults.

---

## ðŸ“Š Extend the System

* Add more YAMLs in `config/`
* Add corresponding models in `models.py`
* Update `config_loader.py` to support new types
* Add new FastAPI endpoints in `api.py`

---

## ðŸš€ Use Cases

* Hadith grading classifier
* Narrator graph visualizer
* Chain scoring tools
* Book OCR to structure pipelines
* Named entity linking for classical texts

---

## ðŸŒŸ Summary Principle

> Treat your YAMLs like API contracts. Modular, validated, reusable.

This structure is scalable to any domain: Arabic contracts, medical text, poetry tagging, legal NLP, etc.

---

## ðŸ”„ Importing Non-Package Modules (e.g. `external_modules/`)

To safely use code from `external_modules/` without converting it into a package, use this snippet at the top of any script:

```python
import sys
from pathlib import Path

# Dynamically add root directory to sys.path
ROOT_DIR = Path(__file__).resolve().parents[3]
if str(ROOT_DIR) not in sys.path:
    sys.path.insert(0, str(ROOT_DIR))

# Now you can do:
from external_modules.some_tool import my_function
```

âœ… Works in Jupyter, FastAPI, and CLI scripts.
âœ… No need to modify environment variables.
âœ… Keeps `external_modules/` completely plug-and-play.

Or use this utility in a shared helper:

```python
# utils/sysconfig.py
import sys
from pathlib import Path

def add_project_root(levels_up=3):
    root = Path(__file__).resolve().parents[levels_up]
    if str(root) not in sys.path:
        sys.path.insert(0, str(root))
```

Then in any file:

```python
from utils.sysconfig import add_project_root
add_project_root()
from external_modules.some_tool import my_function
```

---

Need a CLI or full RAG pipeline? Just ask. ðŸš€